# Code generated by KubeVela templates. DO NOT EDIT.
apiVersion: core.oam.dev/v1beta1
kind: TraitDefinition
metadata:
  annotations:
    definition.oam.dev/description: "Mount empty volumes to container."
  name: patch-volume
spec:
  appliesToWorkloads:
    - webservice
    - worker
    - microservice
  schematic:
    cue:
      template: |-
        patch: {
        	spec: template: spec: {
        		// +patchKey=name
        		containers: [{
        			name: context.name
        			// +patchKey=name
        			volumeMounts: [
        				for volumeMount in parameter.volumeMounts {
        					name:      volumeMount.name
        					mountPath: volumeMount.path
        				},
        			]
        		}]
        
        		// +patchKey=name
        		volumes: [
        			for volumeMount in parameter.volumeMounts {
        				name: volumeMount.name
        				emptyDir: {
        					if volumeMount.medium != _|_ {
        						medium: volumeMount.medium
        					}
        					if volumeMount.sizeLimit != _|_ {
        						sizeLimit: volumeMount.sizeLimit
        					}
        				}
        			},
        		]
        	}
        }
        
        #VolumeMount: {
        	name:       string
        	path:       string
        	medium?:    string
        	sizeLimit?: string
        }
        
        parameter: {
        	volumeMounts: [...#VolumeMount]
        }
        
