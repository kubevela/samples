# Code generated by KubeVela templates. DO NOT EDIT.
apiVersion: core.oam.dev/v1beta1
kind: TraitDefinition
metadata:
  annotations:
    definition.oam.dev/description: "A Probe detect the pod status by executing command."
  name: patch-cmd-probe
spec:
  appliesToWorkloads:
    - microservice
  schematic:
    cue:
      template: |-
        patch: {
        	spec: template: spec: {
        		// +patchKey=name
        		containers: [{
        			name: context.name
        			readinessProbe: {
        				initialDelaySeconds: parameter.readinessProbe.waitServiceStartUpSeconds
        				periodSeconds:       parameter.readinessProbe.periodSeconds
        				exec: command: parameter.readinessProbe.cmd
        			}
        			livenessProbe: {
        				initialDelaySeconds: parameter.livenessProbe.waitServiceStartUpSeconds
        				periodSeconds:       parameter.livenessProbe.periodSeconds
        				exec: command: parameter.livenessProbe.cmd
        			}
        		}]
        	}
        }
        #ProbeAction: {
        	// +usage=Number of seconds after the container has started before liveness probes are initiated
        	waitServiceStartUpSeconds: *20 | int
        
        	// +usage=How often (in seconds) to perform the probe
        	periodSeconds: *10 | int
        
        	// +usage=Command is the command line to execute inside the container
        	cmd: [...string]
        }
        
        parameter: {
        	readinessProbe: #ProbeAction
        	livenessProbe:  #ProbeAction
        }
        
