# Code generated by KubeVela templates. DO NOT EDIT.
apiVersion: core.oam.dev/v1beta1
kind: TraitDefinition
metadata:
  annotations:
    definition.oam.dev/description: "Create a LoadBalancer for the specified Pod."
  name: patch-loadbalancer
spec:
  appliesToWorkloads:
    - microservice
  schematic:
    cue:
      template: |-
        outputs: loadbalancer: {
          apiVersion: "v1"
          kind:       "Service"
          metadata: {
            name: context.name + "-external"
          }
          spec: {
            type: "LoadBalancer"
            selector: {
              app: context.name
              "app.oam.dev/appRevision": context.appRevision
            }
            ports: [{
              port: parameter.servicePort
              if parameter.containerPort != _|_ {
                targetPort: parameter.containerPort
              }
              if parameter.containerPort == _|_ {
                targetPort: parameter.servicePort
              }
            }]
          }
        }
        
        parameter: {
          servicePort:    int
          containerPort?: int
        }
        
